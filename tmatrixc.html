<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Cylindrical T-matrices &#8212; treams 0.3.1.dev1+gf7385239 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/pyramid.css" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="S-Matrices for plane waves" href="smatrix.html" />
    <link rel="prev" title="T-Matrices" href="tmatrix.html" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head><body>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="smatrix.html" title="S-Matrices for plane waves"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tmatrix.html" title="T-Matrices"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">treams 0.3.1.dev1+gf7385239 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="intro.html" accesskey="U">Introduction</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Cylindrical T-matrices</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="cylindrical-t-matrices">
<h1>Cylindrical T-matrices<a class="headerlink" href="#cylindrical-t-matrices" title="Permalink to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#infinitely-long-cylinders" id="id3">(Infinitely long) Cylinders</a></p></li>
<li><p><a class="reference internal" href="#cylindrical-t-matrices-for-one-dimensional-arrays-of-spherical-t-matrices" id="id4">Cylindrical T-matrices for one-dimensional arrays of spherical T-matrices</a></p></li>
<li><p><a class="reference internal" href="#clusters" id="id5">Clusters</a></p></li>
<li><p><a class="reference internal" href="#one-dimensional-arrays-along-the-x-axis" id="id6">One-dimensional arrays (along the x-axis)</a></p></li>
<li><p><a class="reference internal" href="#two-dimensional-arrays-in-the-x-y-plane" id="id7">Two-dimensional arrays (in the x-y-plane)</a></p></li>
</ul>
</nav>
<p>Here, we will cover cylindrical T-matrices, which are distinguished from the more
conventional (spherical) T-matrices through the use of vector cylindrical functions
instead of vector spherical functions. These waves are parametrized by the z-component
of the wave vector <span class="math notranslate nohighlight">\(k_z\)</span>, that describes their behavior in the z-direction
<span class="math notranslate nohighlight">\(\mathrm e^{\mathrm i k_z z}\)</span>, and the azimuthal order <span class="math notranslate nohighlight">\(m\)</span>, that is also
used in vector spherical functions. Furthermore, there modes of well-defined parity and
helicity are available.</p>
<p>The cylindrical T-matrices are suited for structures that are periodic in one dimension
(conventionally set along the z-axis). Similarly to T-matrices of spheres that contain
the analytically known Mie coefficients, the cylindrical T-matrices for infinitely long
cylinders can also be calculated analytically.</p>
<p>Another similarity to spherical T-matrices are the possibilities to describe clusters of
objects in a local and global basis and to place these objects in a lattice. The
lattices can only extend in one and two dimensions; the z-direction is implicitly
periodic already.</p>
<section id="infinitely-long-cylinders">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">(Infinitely long) Cylinders</a><a class="headerlink" href="#infinitely-long-cylinders" title="Permalink to this heading">¶</a></h2>
<p>The first simple object, for which we’ll calculate the cylindrical T-matrix is an
infinitely long cylinder. (Similar to the case of spheres and T-matrices those
cylinders could also have multiple concentric shells.) Due to the rotation symmetry
about the z-axis this matrix is diagonal with respect to <code class="code docutils literal notranslate"><span class="pre">m</span></code> and due to the
translation symmetry it is also diagonal with respect to <code class="code docutils literal notranslate"><span class="pre">kz</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">k0s</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">6000</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">materials</span> <span class="o">=</span> <span class="p">[</span><span class="n">treams</span><span class="o">.</span><span class="n">Material</span><span class="p">(</span><span class="mi">16</span> <span class="o">+</span> <span class="mf">0.5</span><span class="n">j</span><span class="p">),</span> <span class="n">treams</span><span class="o">.</span><span class="n">Material</span><span class="p">()]</span>
<span class="n">mmax</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">radius</span> <span class="o">=</span> <span class="mi">75</span>
<span class="n">kzs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">cylinders</span> <span class="o">=</span> <span class="p">[</span><span class="n">treams</span><span class="o">.</span><span class="n">TMatrixC</span><span class="o">.</span><span class="n">cylinder</span><span class="p">(</span><span class="n">kzs</span><span class="p">,</span> <span class="n">mmax</span><span class="p">,</span> <span class="n">k0</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">materials</span><span class="p">)</span> <span class="k">for</span> <span class="n">k0</span> <span class="ow">in</span> <span class="n">k0s</span><span class="p">]</span>
</pre></div>
</div>
<p>For such infinitely long structures it makes more sense to talk about cross width
instead of cross section. We obtain the averaged scattering and extinction cross width
by</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xw_sca</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">tm</span><span class="o">.</span><span class="n">xw_sca_avg</span> <span class="k">for</span> <span class="n">tm</span> <span class="ow">in</span> <span class="n">cylinders</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">radius</span><span class="p">)</span>
<span class="n">xw_ext</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">tm</span><span class="o">.</span><span class="n">xw_ext_avg</span> <span class="k">for</span> <span class="n">tm</span> <span class="ow">in</span> <span class="n">cylinders</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">radius</span><span class="p">)</span>

</pre></div>
</div>
<p>Again, we can also select specific modes only, for example the modes with <span class="math notranslate nohighlight">\(m = 0\)</span>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cwb_mmax0</span> <span class="o">=</span> <span class="n">treams</span><span class="o">.</span><span class="n">CylindricalWaveBasis</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">kzs</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">cylinders_mmax0</span> <span class="o">=</span> <span class="p">[</span><span class="n">tm</span><span class="p">[</span><span class="n">cwb_mmax0</span><span class="p">]</span> <span class="k">for</span> <span class="n">tm</span> <span class="ow">in</span> <span class="n">cylinders</span><span class="p">]</span>
<span class="n">xw_sca_mmax0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">tm</span><span class="o">.</span><span class="n">xw_sca_avg</span> <span class="k">for</span> <span class="n">tm</span> <span class="ow">in</span> <span class="n">cylinders_mmax0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">radius</span><span class="p">)</span>
<span class="n">xw_ext_mmax0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">tm</span><span class="o">.</span><span class="n">xw_ext_avg</span> <span class="k">for</span> <span class="n">tm</span> <span class="ow">in</span> <span class="n">cylinders_mmax0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">radius</span><span class="p">)</span>
</pre></div>
</div>
<p>to calculate their cross width. Evaluating the field intensity in the x-y-plane is
equally simple.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cwb_mmax0</span> <span class="o">=</span> <span class="n">treams</span><span class="o">.</span><span class="n">CylindricalWaveBasis</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">kzs</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">cylinders_mmax0</span> <span class="o">=</span> <span class="p">[</span><span class="n">tm</span><span class="p">[</span><span class="n">cwb_mmax0</span><span class="p">]</span> <span class="k">for</span> <span class="n">tm</span> <span class="ow">in</span> <span class="n">cylinders</span><span class="p">]</span>
<span class="n">xw_sca_mmax0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">tm</span><span class="o">.</span><span class="n">xw_sca_avg</span> <span class="k">for</span> <span class="n">tm</span> <span class="ow">in</span> <span class="n">cylinders_mmax0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">radius</span><span class="p">)</span>
<span class="n">xw_ext_mmax0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">tm</span><span class="o">.</span><span class="n">xw_ext_avg</span> <span class="k">for</span> <span class="n">tm</span> <span class="ow">in</span> <span class="n">cylinders_mmax0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">radius</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="_downloads/324821477b4dad4667ed6c66c6c6b252/cylinder_tmatrixc.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>)</p>
<figure class="align-default" id="id1">
<img alt="_images/cylinder_tmatrixc_00.png" class="plot-directive" src="_images/cylinder_tmatrixc_00.png" />
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="_downloads/486fde23a88c68d4f5bf2f75fdf5746c/cylinder_tmatrixc_00.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/be160498cd9989baf45b1ae8bbf4cac8/cylinder_tmatrixc_00.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/8bdf80f0b426d91d0f6756932c0f6212/cylinder_tmatrixc_00.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id2">
<img alt="_images/cylinder_tmatrixc_01.png" class="plot-directive" src="_images/cylinder_tmatrixc_01.png" />
<figcaption>
<p><span class="caption-text">(<a class="reference download internal" download="" href="_downloads/6e006d862214c45c3d2dc8feb4231c53/cylinder_tmatrixc_01.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/e980714f5d866e25c3f9563d466984a2/cylinder_tmatrixc_01.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/7c9ab506d8614dddb2bd0f9dcb4ee96c/cylinder_tmatrixc_01.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="cylindrical-t-matrices-for-one-dimensional-arrays-of-spherical-t-matrices">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Cylindrical T-matrices for one-dimensional arrays of spherical T-matrices</a><a class="headerlink" href="#cylindrical-t-matrices-for-one-dimensional-arrays-of-spherical-t-matrices" title="Permalink to this heading">¶</a></h2>
<p>For our next example we want to look at the system of spheres on a one-dimensional
lattice again (<a class="reference internal" href="tmatrix.html#one-dimensional-arrays-along-z"><span class="std std-ref">One-dimensional arrays (along z)</span></a>). They fulfil all
properties that define structures where the use of cylindrical waves is beneficial,
namely they have a finite extent in the x-y-plane and they are periodic along the
z-direction.</p>
<p>So, the initial setup of our calculation starts with spheres in the spherical wave
basis and place them in a chain. This is the same procedure as in
<a class="reference internal" href="tmatrix.html#one-dimensional-arrays-along-z"><span class="std std-ref">One-dimensional arrays (along z)</span></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">k0s</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">6000</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">materials</span> <span class="o">=</span> <span class="p">[</span><span class="n">treams</span><span class="o">.</span><span class="n">Material</span><span class="p">(</span><span class="mi">16</span> <span class="o">+</span> <span class="mf">0.5</span><span class="n">j</span><span class="p">),</span> <span class="n">treams</span><span class="o">.</span><span class="n">Material</span><span class="p">()]</span>
<span class="n">mmax</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">radius</span> <span class="o">=</span> <span class="mi">75</span>
<span class="n">kzs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">cylinders</span> <span class="o">=</span> <span class="p">[</span><span class="n">treams</span><span class="o">.</span><span class="n">TMatrixC</span><span class="o">.</span><span class="n">cylinder</span><span class="p">(</span><span class="n">kzs</span><span class="p">,</span> <span class="n">mmax</span><span class="p">,</span> <span class="n">k0</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">materials</span><span class="p">)</span> <span class="k">for</span> <span class="n">k0</span> <span class="ow">in</span> <span class="n">k0s</span><span class="p">]</span>

<span class="n">xw_sca</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">tm</span><span class="o">.</span><span class="n">xw_sca_avg</span> <span class="k">for</span> <span class="n">tm</span> <span class="ow">in</span> <span class="n">cylinders</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">radius</span><span class="p">)</span>
<span class="n">xw_ext</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">tm</span><span class="o">.</span><span class="n">xw_ext_avg</span> <span class="k">for</span> <span class="n">tm</span> <span class="ow">in</span> <span class="n">cylinders</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">radius</span><span class="p">)</span>

</pre></div>
</div>
<p>Next, we convert this chain in the spherical wave basis to a suitable cylindrical wave
basis.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cylinders_mmax0</span> <span class="o">=</span> <span class="p">[</span><span class="n">tm</span><span class="p">[</span><span class="n">cwb_mmax0</span><span class="p">]</span> <span class="k">for</span> <span class="n">tm</span> <span class="ow">in</span> <span class="n">cylinders</span><span class="p">]</span>
<span class="n">xw_sca_mmax0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">tm</span><span class="o">.</span><span class="n">xw_sca_avg</span> <span class="k">for</span> <span class="n">tm</span> <span class="ow">in</span> <span class="n">cylinders_mmax0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">radius</span><span class="p">)</span>
<span class="n">xw_ext_mmax0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">tm</span><span class="o">.</span><span class="n">xw_ext_avg</span> <span class="k">for</span> <span class="n">tm</span> <span class="ow">in</span> <span class="n">cylinders_mmax0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">radius</span><span class="p">)</span>
</pre></div>
</div>
<p>We chose to add the first three diffraction orders (plus a 0.1 margin to avoid problems
with floating point comparisons).</p>
<p>Finally, we set-up the illumination and calculate the scattering with the usual
procedure.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tm</span> <span class="o">=</span> <span class="n">cylinders</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">inc</span> <span class="o">=</span> <span class="n">treams</span><span class="o">.</span><span class="n">plane_wave</span><span class="p">([</span><span class="n">tm</span><span class="o">.</span><span class="n">k0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k0</span><span class="o">=</span><span class="n">tm</span><span class="o">.</span><span class="n">k0</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">tm</span><span class="o">.</span><span class="n">material</span><span class="p">)</span>
<span class="n">sca</span> <span class="o">=</span> <span class="n">tm</span> <span class="o">@</span> <span class="n">inc</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">tm</span><span class="o">.</span><span class="n">basis</span><span class="p">)</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:</span><span class="mi">100</span><span class="p">:</span><span class="mi">101</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">:</span><span class="mi">100</span><span class="p">:</span><span class="mi">101</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">intensity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">valid</span> <span class="o">=</span> <span class="n">tm</span><span class="o">.</span><span class="n">valid_points</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="p">[</span><span class="n">radius</span><span class="p">])</span>
<span class="n">intensity</span><span class="p">[</span><span class="o">~</span><span class="n">valid</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</pre></div>
</div>
<p>We evaluate the fields in two regions. Outside of the circumscribing cylinders we can
use the fast cylindrical wave expansion. Inside of the circumscribing cylinders but
outside of the spheres we can use the method of
<a class="reference internal" href="tmatrix.html#one-dimensional-arrays-along-z"><span class="std std-ref">One-dimensional arrays (along z)</span></a>.</p>
<p>Finally, we can plot the results. To illustrate the periodicity better, three unit cells
are shown.</p>
<p>(<a class="reference download internal" download="" href="_downloads/5236e293f35f25d568f5be377e7e739b/chain_tmatrixc.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="_downloads/fae344f23063f98ca33608139da0aca2/chain_tmatrixc.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/e27a71c824dced3140e8cb177374d1e6/chain_tmatrixc.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/4a7c67b9ac1e0fdbe3f51088596eb635/chain_tmatrixc.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/chain_tmatrixc.png" class="plot-directive" src="_images/chain_tmatrixc.png" />
</figure>
</section>
<section id="clusters">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Clusters</a><a class="headerlink" href="#clusters" title="Permalink to this heading">¶</a></h2>
<p>Similarly to the case of spheres we can also calculate the response from a cluster of
objects. For the example want to simulate a cylinder together with a chain of spheres
in the cylindrical wave basis as described in the previous section.</p>
<p>So, we set up first the spheres in the chain and convert them to the cylindrical wave
basis as before</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">k0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">700</span>
<span class="n">materials</span> <span class="o">=</span> <span class="p">[</span><span class="n">treams</span><span class="o">.</span><span class="n">Material</span><span class="p">(</span><span class="o">-</span><span class="mf">16.5</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="p">),</span> <span class="n">treams</span><span class="o">.</span><span class="n">Material</span><span class="p">()]</span>
<span class="n">lmax</span> <span class="o">=</span> <span class="n">mmax</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">radii</span> <span class="o">=</span> <span class="p">[</span><span class="mi">65</span><span class="p">,</span> <span class="mi">55</span><span class="p">]</span>
<span class="n">positions</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="n">lattice</span> <span class="o">=</span> <span class="n">treams</span><span class="o">.</span><span class="n">Lattice</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
<span class="n">kz</span> <span class="o">=</span> <span class="mf">0.005</span>

<span class="n">sphere</span> <span class="o">=</span> <span class="n">treams</span><span class="o">.</span><span class="n">TMatrix</span><span class="o">.</span><span class="n">sphere</span><span class="p">(</span><span class="n">lmax</span><span class="p">,</span> <span class="n">k0</span><span class="p">,</span> <span class="n">radii</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">materials</span><span class="p">)</span>
<span class="n">chain</span> <span class="o">=</span> <span class="n">sphere</span><span class="o">.</span><span class="n">latticeinteraction</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">lattice</span><span class="p">,</span> <span class="n">kz</span><span class="p">)</span>
<span class="n">bmax</span> <span class="o">=</span> <span class="mf">3.1</span> <span class="o">*</span> <span class="n">lattice</span><span class="o">.</span><span class="n">reciprocal</span>
<span class="n">cwb</span> <span class="o">=</span> <span class="n">treams</span><span class="o">.</span><span class="n">CylindricalWaveBasis</span><span class="o">.</span><span class="n">diffr_orders</span><span class="p">(</span><span class="n">kz</span><span class="p">,</span> <span class="n">mmax</span><span class="p">,</span> <span class="n">lattice</span><span class="p">,</span> <span class="n">bmax</span><span class="p">)</span>
<span class="n">chain_tmc</span> <span class="o">=</span> <span class="n">treams</span><span class="o">.</span><span class="n">TMatrixC</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span><span class="n">chain</span><span class="p">,</span> <span class="n">cwb</span><span class="p">)</span>
</pre></div>
</div>
<p>Then, we create the cylinder T-matrix in the cylindrical wave basis</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cylinder</span> <span class="o">=</span> <span class="n">treams</span><span class="o">.</span><span class="n">TMatrixC</span><span class="o">.</span><span class="n">cylinder</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">cwb</span><span class="o">.</span><span class="n">kz</span><span class="p">),</span> <span class="n">mmax</span><span class="p">,</span> <span class="n">k0</span><span class="p">,</span> <span class="n">radii</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">materials</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, we construct the cluster and let the interaction be solved</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cluster</span> <span class="o">=</span> <span class="n">treams</span><span class="o">.</span><span class="n">TMatrixC</span><span class="o">.</span><span class="n">cluster</span><span class="p">([</span><span class="n">chain_tmc</span><span class="p">,</span> <span class="n">cylinder</span><span class="p">],</span> <span class="n">positions</span><span class="p">)</span><span class="o">.</span><span class="n">interaction</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="n">inc</span> <span class="o">=</span> <span class="n">treams</span><span class="o">.</span><span class="n">plane_wave</span><span class="p">(</span>
    <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">k0</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">kz</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">kz</span><span class="p">],</span>
    <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)],</span>
    <span class="n">k0</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">k0</span><span class="p">,</span>
    <span class="n">material</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">material</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">sca</span> <span class="o">=</span> <span class="n">cluster</span> <span class="o">@</span> <span class="n">inc</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">cluster</span><span class="o">.</span><span class="n">basis</span><span class="p">)</span>
</pre></div>
</div>
<p>and we solve calculate the scattered field coefficients, whose field representation we
then plot</p>
<p>(<a class="reference download internal" download="" href="_downloads/9c856a1b2c00decdfeed2136112981c3/cluster_tmatrixc.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="_downloads/ab9c5052c531f3f80d0cb45fb3fa5a1f/cluster_tmatrixc.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/067a2a7a115448e94e7a47db5318923c/cluster_tmatrixc.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/23a419322006a5b3216faeba8603d6af/cluster_tmatrixc.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/cluster_tmatrixc.png" class="plot-directive" src="_images/cluster_tmatrixc.png" />
</figure>
</section>
<section id="one-dimensional-arrays-along-the-x-axis">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">One-dimensional arrays (along the x-axis)</a><a class="headerlink" href="#one-dimensional-arrays-along-the-x-axis" title="Permalink to this heading">¶</a></h2>
<p>Now, we take the chain of spheres and a cylinder and place them in a grating structure
along the x-direction. We start again by defining the parameters and calculating the
relevant cylindrical T-matrices.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">k0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">700</span>
<span class="n">materials</span> <span class="o">=</span> <span class="p">[</span><span class="n">treams</span><span class="o">.</span><span class="n">Material</span><span class="p">(</span><span class="o">-</span><span class="mf">16.5</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="p">),</span> <span class="n">treams</span><span class="o">.</span><span class="n">Material</span><span class="p">()]</span>
<span class="n">lmax</span> <span class="o">=</span> <span class="n">mmax</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">radii</span> <span class="o">=</span> <span class="p">[</span><span class="mi">65</span><span class="p">,</span> <span class="mi">55</span><span class="p">]</span>
<span class="n">positions</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="n">lattice</span> <span class="o">=</span> <span class="n">treams</span><span class="o">.</span><span class="n">Lattice</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
<span class="n">kz</span> <span class="o">=</span> <span class="mf">0.005</span>

<span class="n">sphere</span> <span class="o">=</span> <span class="n">treams</span><span class="o">.</span><span class="n">TMatrix</span><span class="o">.</span><span class="n">sphere</span><span class="p">(</span><span class="n">lmax</span><span class="p">,</span> <span class="n">k0</span><span class="p">,</span> <span class="n">radii</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">materials</span><span class="p">)</span>
<span class="n">chain</span> <span class="o">=</span> <span class="n">sphere</span><span class="o">.</span><span class="n">latticeinteraction</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">lattice</span><span class="p">,</span> <span class="n">kz</span><span class="p">)</span>
<span class="n">bmax</span> <span class="o">=</span> <span class="mf">3.1</span> <span class="o">*</span> <span class="n">lattice</span><span class="o">.</span><span class="n">reciprocal</span>
<span class="n">cwb</span> <span class="o">=</span> <span class="n">treams</span><span class="o">.</span><span class="n">CylindricalWaveBasis</span><span class="o">.</span><span class="n">diffr_orders</span><span class="p">(</span><span class="n">kz</span><span class="p">,</span> <span class="n">mmax</span><span class="p">,</span> <span class="n">lattice</span><span class="p">,</span> <span class="n">bmax</span><span class="p">)</span>
<span class="n">chain_tmc</span> <span class="o">=</span> <span class="n">treams</span><span class="o">.</span><span class="n">TMatrixC</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span><span class="n">chain</span><span class="p">,</span> <span class="n">cwb</span><span class="p">)</span>

<span class="n">cylinder</span> <span class="o">=</span> <span class="n">treams</span><span class="o">.</span><span class="n">TMatrixC</span><span class="o">.</span><span class="n">cylinder</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">cwb</span><span class="o">.</span><span class="n">kz</span><span class="p">),</span> <span class="n">mmax</span><span class="p">,</span> <span class="n">k0</span><span class="p">,</span> <span class="n">radii</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">materials</span><span class="p">)</span>

</pre></div>
</div>
<p>Next, we create the cluster and, as usual, let it interact within a lattice of the
defined periodicity. Then, it’s simple to calculate the scattering coefficients.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inc</span> <span class="o">=</span> <span class="n">treams</span><span class="o">.</span><span class="n">plane_wave</span><span class="p">(</span>
    <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">k0</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">kz</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">kz</span><span class="p">],</span>
    <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)],</span>
    <span class="n">k0</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">k0</span><span class="p">,</span>
    <span class="n">material</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">material</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">sca</span> <span class="o">=</span> <span class="n">cluster</span> <span class="o">@</span> <span class="n">inc</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">cluster</span><span class="o">.</span><span class="n">basis</span><span class="p">)</span>

<span class="n">grid</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="o">-</span><span class="mi">300</span><span class="p">:</span><span class="mi">300</span><span class="p">:</span><span class="mi">61</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">150</span><span class="p">:</span><span class="mi">150</span><span class="p">:</span><span class="mi">31</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
<p>In the last step, we want to sum up the scattered fields at each point in the probing
area</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ez</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="nb">complex</span><span class="p">)</span>
<span class="n">valid</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">valid_points</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">radii</span><span class="p">)</span>
<span class="n">ez</span><span class="p">[</span><span class="n">valid</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">inc</span><span class="o">.</span><span class="n">efield</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="n">valid</span><span class="p">])</span> <span class="o">+</span> <span class="n">sca</span><span class="o">.</span><span class="n">efield</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="n">valid</span><span class="p">]))[</span><span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>

<span class="n">ez</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
    <span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">ez</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">kz</span> <span class="o">*</span> <span class="n">lattice</span><span class="p">[</span><span class="o">...</span><span class="p">])),</span>
        <span class="n">ez</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">real</span><span class="p">,</span>
        <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">ez</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">kz</span> <span class="o">*</span> <span class="n">lattice</span><span class="p">[</span><span class="o">...</span><span class="p">])),</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>and plot the results.</p>
<p>(<a class="reference download internal" download="" href="_downloads/9e54f0a44de2314df0e78fc218980e52/grating_tmatrixc.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="_downloads/58f43d0e5af5cc8d0431555951a7bb95/grating_tmatrixc.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/82904069830a89fc9355311824a58e7c/grating_tmatrixc.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/6ccfadf905d95669273471ac226856b6/grating_tmatrixc.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/grating_tmatrixc.png" class="plot-directive" src="_images/grating_tmatrixc.png" />
</figure>
</section>
<section id="two-dimensional-arrays-in-the-x-y-plane">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Two-dimensional arrays (in the x-y-plane)</a><a class="headerlink" href="#two-dimensional-arrays-in-the-x-y-plane" title="Permalink to this heading">¶</a></h2>
<p>As last example, we want to examine a structure that is a photonic crystal consisting
of infinitely long cylinders in a square array in the x-y-plane.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">k0s</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">materials</span> <span class="o">=</span> <span class="p">[</span><span class="n">treams</span><span class="o">.</span><span class="n">Material</span><span class="p">(</span><span class="mf">12.4</span><span class="p">),</span> <span class="n">treams</span><span class="o">.</span><span class="n">Material</span><span class="p">()]</span>
<span class="n">mmax</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">radius</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">lattice</span> <span class="o">=</span> <span class="n">treams</span><span class="o">.</span><span class="n">Lattice</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">kpar</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">k0</span> <span class="ow">in</span> <span class="n">k0s</span><span class="p">:</span>
    <span class="n">cyl</span> <span class="o">=</span> <span class="n">treams</span><span class="o">.</span><span class="n">TMatrixC</span><span class="o">.</span><span class="n">cylinder</span><span class="p">(</span><span class="n">kpar</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">mmax</span><span class="p">,</span> <span class="n">k0</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">materials</span><span class="p">)</span>
    <span class="n">svd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">cyl</span><span class="o">.</span><span class="n">latticeinteraction</span><span class="p">(</span><span class="n">lattice</span><span class="p">,</span> <span class="n">kpar</span><span class="p">[:</span><span class="mi">2</span><span class="p">]),</span> <span class="n">compute_uv</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">svd</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Frequency (THz)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Smallest singular value&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="mf">299.792458</span> <span class="o">*</span> <span class="n">k0s</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="n">res</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Similarly to the case of spheres and a three-dimensional lattice, we can check the
smallest singular value.</p>
<p>(<a class="reference download internal" download="" href="_downloads/5c06143dbee61d24c66afb6e20ad6349/crystal_tmatrixc.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="_downloads/d258772477cb85b73a7ac50fc7e46df2/crystal_tmatrixc.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/b9c0dc33d1f6b1c10e8abfc2e1f2bade/crystal_tmatrixc.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/e5badc76e924732d0a242ce10ae780cb/crystal_tmatrixc.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/crystal_tmatrixc.png" class="plot-directive" src="_images/crystal_tmatrixc.png" />
</figure>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="gettingstarted.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="theory.html">Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="treams.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev.html">Development and contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a></li>
</ul>

  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="tmatrix.html"
                          title="previous chapter">T-Matrices</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="smatrix.html"
                          title="next chapter">S-Matrices for plane waves</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/tmatrixc.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="smatrix.html" title="S-Matrices for plane waves"
             >next</a> |</li>
        <li class="right" >
          <a href="tmatrix.html" title="T-Matrices"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">treams 0.3.1.dev1+gf7385239 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="intro.html" >Introduction</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Cylindrical T-matrices</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2023, Dominik Beutel.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.0.1.
    </div>
  </body>
</html>